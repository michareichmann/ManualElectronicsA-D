\mdfsetup{skipabove=\topskip,skipbelow=\topskip}
\newcounter{task}[section]
\newenvironment{task}[1][]{%
\stepcounter{task}%
\ifstrempty{#1}
{\mdfsetup{%
frametitle=\null\hspace*{1em}{%
\tikz[baseline=(current bounding box.east),outer sep=0pt, rounded corners=2mm]
\node[anchor=east,rectangle,fill=red!30, draw=red,line width=1pt]
{\strut Task~\thetask};}}%
}{}%
\mdfsetup{roundcorner=5pt, frametitleaboveskip=-12pt\relax, frametitlebelowskip=0pt, innerleftmargin=1em, linecolor=red!50, backgroundcolor=red!5}

\begin{mdframed}[]\relax\bfseries%
}{\end{mdframed}}
